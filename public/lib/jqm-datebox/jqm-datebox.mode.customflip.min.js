/*! jQuery-Mobile-DateBox  |2015-09-24T15:09:55Z | (c) 2010,  2015 JTSage | https://github.com/jtsage/jquery-mobile-datebox/blob/master/LICENSE.txt */

!function(a){a.extend(a.mobile.datebox.prototype.options,{themeOptPick:"b",themeOpt:"a",useSetButton:!0,customData:[],customDefault:[0,0,0],customDataLen:25,customFormat:!1,customHead:!1,customfliplang:{customSet:"Looks Good"}}),a.extend(a.mobile.datebox.prototype,{_customflipDoSet:function(){var a=this,b=this.options;"undefined"==typeof a.customCurrent&&(a.customCurrent=this._makeDate(this.d.input.val())),a._t({method:"set",value:a._formatter(b.customFormat,a.customCurrent),custom:a.customCurrent})},_cubox_offset:function(a,b){var c,d=this,e=this.options;c=(d.customCurrent[a]+b)%e.customData[a].data.length,0>c&&(c=e.customData[a].data.length+c),d.customCurrent[a]=c,e.useImmediate&&d._t({method:"set",value:d._formatter(e.customFormat,d.customCurrent),custom:d.customCurrent}),d.refresh()},_cubox_arr:function(b,c){for(var d,e=b,f=this.options.customDataLen,g=b.slice(0,c),h=b.slice(c+1);g.length<f;)for(d=e.length;d>0;d--)g.unshift(e[d-1]);for(;g.length>f;)g.shift();for(;h.length<f;)for(d=0;d<e.length;d++)h.push(e[d]);return h.length=f,g.push(b[c]),a.merge(a.merge([],g),h)},_cubox_range:function(a){return a?this._cubox_range(a-1).concat(a):[]},_cubox_pos:function(){var b,c,d,e,f=this,g=this.d.intHTML.find(".ui-datebox-flipcontent").innerHeight();f.d.intHTML.find(".ui-datebox-flipcenter").each(function(){c=a(this),d=c.innerHeight(),c.css("top",-1*(g/2-d/2-3))}),f.d.intHTML.find("ul").each(function(){c=a(this),g=c.parent().innerHeight(),d=c.find("li").first(),e=c.find("li").last().offset().top-c.find("li").first().offset().top,b=-1*((e-g)/2+d.outerHeight()),d.css("marginTop",b)})}}),a.extend(a.mobile.datebox.prototype._parser,{customflip:function(b){var c,d,e,f,g=this.options,h=g.customFormat,i=[0,0,0,0,0,0];if("string"!=typeof h&&(h=""),h=h.replace(/%X([0-5a-f])/gi,function(a,b){switch(b){case"a":case"b":case"c":case"d":case"e":case"f":return"("+a+"|.+?)";case"0":case"1":case"2":case"3":case"4":case"5":return"("+a+"|[0-9]+)";default:return".+?"}}),h=new RegExp("^"+h+"$"),c=h.exec(b),d=h.exec(g.customFormat),null!==c)for(var j=1;j<c.length;j++)e=d[j].charAt(2),isNaN(parseInt(e))?(f=a.inArray(e,["a","b","c","d","e","f"]),i[f]=a.inArray(c[j],g.customData[f].data)):i[parseInt(e)-1]=parseInt(c[j]);return b.length<1||i.length<1?g.customDefault:i}}),a.extend(a.mobile.datebox.prototype._customformat,{customflip:function(b,c,d){var e,f=parseInt(b);return"number"!=typeof f||isNaN(f)?(e=a.inArray(b,["a","b","c","d","e","f"]),d.customData[e].data[c[e]]):c[b-1]}}),a.extend(a.mobile.datebox.prototype._build,{customflip:function(){var b,c,d,e,f,g,h=this,i=this.options,j="ui-datebox-",k=this._makeDate(this.d.input.val()),l=a("<div class='ui-overlay-shadow'><ul></ul></div>"),m=a("<div>",{"class":j+"flipcontent"});if("undefined"==typeof h.customCurrent&&(h.customCurrent=k),"string"==typeof i.customData&&"undefined"!=typeof window[i.customData]&&(i.customData=window[i.customData]),i.customFormat===!1){for(f=[],b=0;b<i.customData.length;b++)f.push("%X"+(b+1));i.customFormat=f.join(",")}for("boolean"!=typeof h.d.intHTML?h.d.intHTML.empty().remove():h.d.input.on("datebox",function(a,b){"postrefresh"===b.method&&h._cubox_pos()}),h.d.headerText=i.customHead!==!1?i.customHead:h._grabLabel()!==!1?h._grabLabel():"",h.d.intHTML=a("<span>"),a(document).one("popupafteropen",function(){h._cubox_pos()}),h.fldOrder=h._cubox_range(i.customData.length),f=a("<div class='"+j+"header'>"),i.customData.length>1&&f.addClass("ui-grid-"+[0,0,"a","b","c"][i.customData.length]),c=0;c<i.customData.length;c++)a("<div>").addClass(i.customData.length>1?"ui-block-"+["a","b","c","d"][c]:"").text(i.customData[c].name).css("textAlign","center").appendTo(f);for(f.appendTo(h.d.intHTML),h.d.intHTML.append(m),c=0;c<i.customData.length;c++){for(g=h._cubox_arr(i.customData[c].data,h.customCurrent[c]),d=h._makeEl(l,{attr:{field:c,amount:1}}),e=d.find("ul"),1===i.customData.length&&d.css("width","90%"),b=0;b<g.length;b++)f=b!==i.customDataLen?i.themeOpt:i.themeOptPick,console.log(b+" "+i.customDataLen),console.log(typeof b+" "+typeof i.customDataLen),a("<li>",{"class":"ui-body-"+f}).html("<span>"+g[b]+"</span>").appendTo(e);d.appendTo(m)}a("<div>",{"class":j+"flipcenter ui-overlay-shadow"}).css("pointerEvents","none").appendTo(h.d.intHTML),i.useSetButton&&(c=a("<div>",{"class":j+"controls"}),i.useSetButton&&a("<a href='#' role='button'>").appendTo(c).text(h.__("customSet")).addClass("ui-btn ui-btn-"+i.theme+" ui-icon-check ui-btn-icon-left ui-shadow ui-corner-all").on(i.clickEventAlt,function(a){a.preventDefault(),h._t({method:"set",value:h._formatter(i.customFormat,h.customCurrent),custom:h.customCurrent}),h._t({method:"close"})}),c.appendTo(h.d.intHTML)),h.wheelExists&&h.d.intHTML.on("mousewheel",".ui-overlay-shadow",function(b,c){b.preventDefault(),h._cubox_offset(a(this).data("field"),(0>c?1:-1)*a(this).data("amount"))}),h.d.intHTML.on(h.drag.eStart,"ul",function(b,c){h.drag.move||("undefined"!=typeof c&&(b=c),h.drag.move=!0,h.drag.target=a(this).find("li").first(),h.drag.pos=parseInt(h.drag.target.css("marginTop").replace(/px/i,""),10),h.drag.start=h.touch?b.originalEvent.changedTouches[0].pageY:b.pageY,h.drag.end=!1,b.stopPropagation(),b.preventDefault())})}}),a.extend(a.mobile.datebox.prototype._drag,{customflip:function(){var b=this,c=this.options,d=this.drag;a(document).on(d.eMove,function(a){return d.move&&"customflip"===c.mode?(d.end=b.touch?a.originalEvent.changedTouches[0].pageY:a.pageY,d.target.css("marginTop",d.pos+d.end-d.start+"px"),a.preventDefault(),a.stopPropagation(),!1):void 0}),a(document).on(d.eEnd,function(a){d.move&&"customflip"===c.mode&&(d.move=!1,d.end!==!1&&(a.preventDefault(),a.stopPropagation(),d.tmp=d.target.parent().parent(),b._cubox_offset(d.tmp.data("field"),parseInt((d.start-d.end)/d.target.innerHeight(),10)*d.tmp.data("amount"))),d.start=!1,d.end=!1)})}})}(jQuery);
//# sourceMappingURL=jqm-datebox.mode.customflip.min.js.map